# ğŸš N3xT Shellcode Runner CLI

Shellcodeë¥¼ ë¡œë“œí•˜ê³  ì‹¤í–‰/ë””ë²„ê¹…í•  ìˆ˜ ìˆëŠ” Rust ê¸°ë°˜ CLI ë„êµ¬ì„.  
ë¶„ì„ ë° í…ŒìŠ¤íŠ¸ ëª©ì ìœ¼ë¡œ ì„¤ê³„ëìœ¼ë©°, **VM í™˜ê²½ì—ì„œë§Œ ì‚¬ìš©**í•˜ëŠ” ê²ƒì„ ê¶Œì¥í•¨.

## ğŸ“œ ëª©ì°¨
- [ğŸš N3xT Shellcode Runner CLI](#-n3xt-shellcode-runner-cli)
  - [ğŸ“œ ëª©ì°¨](#-ëª©ì°¨)
  - [ğŸ” í”„ë¡œì íŠ¸ ì†Œê°œ](#-í”„ë¡œì íŠ¸-ì†Œê°œ)
  - [âœ¨ ì£¼ìš” ê¸°ëŠ¥](#-ì£¼ìš”-ê¸°ëŠ¥)
  - [ğŸ–¼ï¸ ì‹¤í–‰ ì˜ˆì‹œ](#ï¸-ì‹¤í–‰-ì˜ˆì‹œ)
  - [âš™ï¸ ì„¤ì¹˜ ë° ë¹Œë“œ](#ï¸-ì„¤ì¹˜-ë°-ë¹Œë“œ)
  - [â–¶ï¸ ì‚¬ìš©ë²•](#ï¸-ì‚¬ìš©ë²•)
  - [ğŸ“‚ í”„ë¡œì íŠ¸ êµ¬ì¡°](#-í”„ë¡œì íŠ¸-êµ¬ì¡°)
  - [ğŸ§© ë™ì‘ ì›ë¦¬](#-ë™ì‘-ì›ë¦¬)
  - [ğŸ”’ ì£¼ì˜ì‚¬í•­](#-ì£¼ì˜ì‚¬í•­)
  - [ğŸ ë””ë²„ê¹… ê°€ì´ë“œ](#-ë””ë²„ê¹…-ê°€ì´ë“œ)

## ğŸ” í”„ë¡œì íŠ¸ ì†Œê°œ
- **ëª©ì :** Shellcodeë¥¼ ë©”ëª¨ë¦¬ì— ë¡œë“œí•˜ê³  Thread ë‹¨ìœ„ë¡œ ì‹¤í–‰í•  ìˆ˜ ìˆëŠ” ë„êµ¬
- **í”Œë«í¼:** Windows x64/x86
- **ì£¼ìš” ì‚¬ìš© ì‚¬ë¡€:**
  - ì•…ì„±ì½”ë“œ ë¶„ì„ ë° PoC í…ŒìŠ¤íŠ¸
  - Shellcode ë””ë²„ê¹… ë° ë¶„ì„ í™˜ê²½ ì œê³µ

## âœ¨ ì£¼ìš” ê¸°ëŠ¥
- íŒŒì¼ì—ì„œ Shellcode ì½ê¸° ë° ë©”ëª¨ë¦¬ ë§¤í•‘
- Shellcode ì‹¤í–‰ ìŠ¤ë ˆë“œ Suspend/Resume ì§€ì›
- HEX Previewë¡œ Shellcode ì¼ë¶€ ë‚´ìš© ì¶œë ¥

## ğŸ–¼ï¸ ì‹¤í–‰ ì˜ˆì‹œ
```powershell
> .\n3xtSCrun32.exe -f .\example.bin -s 0

+==============================================================+
|                                                              |
|           _____     _     ____   ____                        |
|     _ __ |___ /_  _| |_  / ___| / ___|  _ __ _   _ _ __      |
|    | '_ \  |_ \ \/ / __| \___ \| |     | '__| | | | '_ \     |
|    | | | |___) >  <| |_   ___) | |___  | |  | |_| | | | |    |
|    |_| |_|____/_/\_\\__| |____/ \____| |_|   \__,_|_| |_|    |
|                                                              |
+==============================================================+
[i] N3xT Shellcode Runner CLI 32-bit

â”€â”€ Input Parameters â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[>] Parsing CLI argumentsâ€¦
[+] CLI arguments parsed.
  Shellcode File Path          .\example.bin
  Shellcode Start Offset       0x0 (0)
  Shellcode Memory Size        None

â”€â”€ Load â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[>] Loading shellcodeâ€¦
[+] Shellcode loaded.
  Entry Address                0x690000 (6881280)
  Aligned Size                 0x1000 (4096)
  Payload Size                 0x2 (2)
  Content Preview              EB FE

â”€â”€ Spawn â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[>] Creating suspended threadâ€¦
[+] Thread created (suspended).
  Thread ID                    0x68A4 (26788)

â”€â”€ Debug â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[!] Shellcode thread is suspended.
[!] Attach a debugger NOW if you want to analyze.
[>] Press ENTER to resume executionâ€¦
````

## âš™ï¸ ì„¤ì¹˜ ë° ë¹Œë“œ

```powershell
# ì €ì¥ì†Œ í´ë¡ 
git clone https://github.com/yourname/n3xt_shellcode_runner.git
cd n3xt_shellcode_runner

# ë¹Œë“œ (x64)
cargo build --release

# ë¹Œë“œ (x86)
rustup target add i686-pc-windows-msvc
cargo build --release --target i686-pc-windows-msvc
```

## â–¶ï¸ ì‚¬ìš©ë²•

```powershell
Usage: n3xtSCrun32.exe [OPTIONS] --file-path <FILE_PATH> --start-offset <START_OFFSET>

Options:
  -f, --file-path <FILE_PATH>
  -s, --start-offset <START_OFFSET>
  -m, --mem-size <MEMORY_SIZE>
  -h, --help                         Print help
  -V, --version                      Print version

# ì˜ˆì‹œ
n3xtSCrun32.exe -f ./example.bin -s 0
n3xtSCrun32.exe -f ./example.bin -s 0 -m 0x100
```

| ì˜µì…˜             | ì„¤ëª…                                                                                                    |
| -------------- | ----------------------------------------------------------------------------------------------------- |
| `-f`, `--file_path`    | ì‹¤í–‰í•  Shellcode ë°”ì´ë„ˆë¦¬ íŒŒì¼ ê²½ë¡œ                                                                              |
| `-s`, `--start_offset` | Shellcode ì‹œì‘ ì˜¤í”„ì…‹ (16ì§„ìˆ˜ `0x` í‘œê¸° ì§€ì›)                                                                    |
| `-m`, `--mem-size`   | ë©”ëª¨ë¦¬ ì˜ˆì•½ í¬ê¸°. **ì§€ì •í•˜ì§€ ì•Šìœ¼ë©´ Shellcode í¬ê¸°ë§Œí¼ í• ë‹¹** |

> [!NOTE]
> OS ë©”ëª¨ë¦¬ í˜ì´ì§€ ì •ë ¬(Alignment)ì— ë§ì¶° ì‹¤ì œ í• ë‹¹ í¬ê¸°ê°€ ë‹¬ë¼ì§ˆ ìˆ˜ ìˆìŒ.

## ğŸ“‚ í”„ë¡œì íŠ¸ êµ¬ì¡°

```
src/
 â”œâ”€ main.rs         # ì—”íŠ¸ë¦¬ í¬ì¸íŠ¸
 â”œâ”€ runner.rs       # Runner êµ¬ì¡°ì²´, ì‹¤í–‰ ë¡œì§
 â”œâ”€ shellcode.rs    # Shellcode íƒ€ì… ë° ë¡œë“œ ë¡œì§
 â”œâ”€ thread.rs       # Thread ìƒì„± ë° ì œì–´
 â”œâ”€ logger.rs       # Logger êµ¬ì¡°ì²´, ì¶œë ¥ ìœ í‹¸
 â””â”€ error.rs        # ì˜¤ë¥˜ ì •ì˜
```

## ğŸ§© ë™ì‘ ì›ë¦¬

1. Shellcode íŒŒì¼ì„ ì½ì–´ `VirtualAlloc` APIë¥¼ í†µí•´ ë©”ëª¨ë¦¬ í• ë‹¹í•¨.
2. ì „ë‹¬ëœ Offsetì„ ê¸°ì¤€ìœ¼ë¡œ Suspend ìƒíƒœì˜ Threadë¥¼ ìƒì„±í•¨.
3. ì‚¬ìš©ìê°€ ë””ë²„ê±°ë¥¼ ë¶™ì¸ í›„ Enterë¥¼ ì…ë ¥í•˜ë©´ Resumeë¨.

## ğŸ”’ ì£¼ì˜ì‚¬í•­

* ì´ ë„êµ¬ëŠ” í•™ìŠµ ë° ë¶„ì„ ìš©ë„ì„.
* ì•…ì„± ì½”ë“œ í…ŒìŠ¤íŠ¸ëŠ” ë°˜ë“œì‹œ ìƒŒë“œë°•ìŠ¤, ê°€ìƒë¨¸ì‹  í™˜ê²½ì—ì„œ ì‹¤í–‰í•´ì•¼ í•¨.

## ğŸ ë””ë²„ê¹… ê°€ì´ë“œ

* í”„ë¡œê·¸ë¨ì´ Shellcode ì‹¤í–‰ ìŠ¤ë ˆë“œë¥¼ **Suspend ìƒíƒœ**ë¡œ ì‹œì‘í•¨.
* Attach ì‹œì ì— ë¸Œë ˆì´í¬í¬ì¸íŠ¸ ì„¤ì • í›„ Resume ê°€ëŠ¥í•¨.